# 

 
 # 题目描述 
<p>
这不是错误，而是特点（bugs.pas/c/cpp） <br><br>【问题描述】<br>　　对于一个软件公司来说，在发行一个新软件之后，可以说已经完成了工作。但是实际上，许多软件公司在发行一个新产品之后，还经常发送补丁程序，修改原产品中的错误（当然，有些补丁是要收费的）。<br><br>　　微硬公司就是这样的一个软件公司。今年夏天，以发行了一个新的字处理软件之后，到现在他们已经编写了许多补丁程序。仅仅在这个周末，他们就用新编写的补丁程序解决了软件中的一个大问题。而在每一个补丁程序修改软件中的某些错误时，有可能引起软件中原来存在的某些错误重新发作。发生这种情况是因为当修改一个错误时，补丁程序利用了程序中约定的特别行为，从而导致错误的重新产生。<br><br>　　微硬公司在他们的软件中一共发现了N个错误B={B1，B2，……，Bn}，现在他们一共发送了M个补丁程序P1，P2，……，Pm。如果想要在软件中应用第Pi号补丁程序，则软件中必须存在错误Bi+<=B，并且错误Bi-<=B必须不存在（显然，Bi+∩Bi-为空集）。然后，这个补丁程序将改正错误Fi-<=B（如果错误存在的话），并且产生新的错误Fi+<=B（同样，Fi+∩Fi-为空集）。<br><br>    现在，微硬公司的问题只有一个，他们给出一个原始版本的软件，软件包含了B中的所有错误，然后按照某一顺序在软件中应用补丁程序（应用某个补丁程序时，软件必须符合该补丁程序的应用条件，且运行该程序需要一定的时间）。问怎样才能最快地改在软件中的所有错误（即为修正所有错误而运行的补丁程序的总时间最短）？<br></p> 

 
 # 输入格式 
<p>
输入文件bugs.in<br><br>　　数据从输入文件中读入，文件的第一行包含两个整数N和M，分别表示软件中的错误个数和发送的补丁个数。其中N和M满足条件：1<=N<=20,1<=M<=200<br><br>　　接下来的M行（即第2行至第M+1行）按顺序描述了M个补丁程序的情况。第J行描述第J-1号补丁程序。每一行包含一个整数（表示在软件中应用该补丁程序所需的时间，单位为秒）和两个N个字符的字符串（中间均用一个空格分开）。<br><br>　　第一字符串描述了应用该补丁程序（第J-1号）的条件，即说明在软件中某错误应该存在还是不应该存在。字符串的第i个字符，如果是“+”，表示在软件中必须存在Bi号错误，如果是“-”，表示软件中错误Bi不能存在；如果是“0”，则表示错误Bi存在或不存在均可（即对应用该补丁程序没有影响）。<br><br>　　第二个字符串描述了应用该补丁程序（第J-1号）后的效果，即应用补丁程序后，哪些错误被修改好了，而又产生了哪些新错误。字符串的第i个字符，如果是“+”，表示产生了一个新错误Bi，如果是“-”，表示软件中错误Bi被修改好了；如果是“0”，则表示错误Bi不变（即原来存在，则仍然存在；原来不存在，则也不存在）。<br></p> 

 
 # 输出格式 
<p>
输出文件bugs.out<br><br>　　答案输出到文件中。<br><br>　　请你找到一个应用补丁程序的最优顺序，修改软件中的所有错误，并且所用的时间最少。注意，每个补丁程序是可以应用多次的。<br><br>　　如果存在这样一个序列，请在输出文件的第一行输出应用补丁程序的总时间（单位为秒）；如果找不到这样一个序列，请在输出文件的第一行输出-1。<br></p> 

 
 # 提示 
<p>
样例二<br>输入文件：bugs.dat<br>4 1<br>7 0-0+  ----<br><br>输出文件：bugs.out<br>-1<br></p> 
# 样例数据
<style>
        table,table tr th, table tr td { border:1px solid #0094ff; }
        table { width: 200px; min-height: 25px; line-height: 25px; text-align: center; border-collapse: collapse;}   
    </style>
<table>
	<tr>
		<td>输入样例</td>
		<td>输出样例</td>
	</tr>
<tr><td>3 3
1 000  00-
1 00-  0-+
2 0--  -++
</td><td>8</td></tr></table>
