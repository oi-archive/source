# 

 
 # 题目描述 
<p>
孤岛营救问题（rescue.pas/cpp/c）<br><br>【问题描述】<br><br>　　1944 年，特种兵麦克接到国防部的命令，要求立即赶赴太平洋上的一个孤岛，营救被敌军俘虏的大兵瑞恩。瑞恩被关押在一个迷宫里，迷宫地形复杂，但幸好麦克得到了迷宫的地形图。迷宫的外形是一个长方形，其南北方向被划分为N 行，东西方向被划分为M列，于是整个迷宫被划分为N×M 个单元。每一个单元的位置可用一个有序数对(单元的行号，单元的列号)来表示。南北或东西方向相邻的2 个单元之间可能互通，也可能有一扇锁着的门，或者是一堵不可逾越的墙。迷宫中有一些单元存放着钥匙，并且所有的门被分成P类，打开同一类的门的钥匙相同，不同类门的钥匙不同。<br>　　大兵瑞恩被关押在迷宫的东南角，即(N，M)单元里，并已经昏迷。迷宫只有一个入口，在西北角。也就是说，麦克可以直接进入(1，1)单元。另外，麦克从一个单元移动到另一个相邻单元的时间为1，拿取所在单元的钥匙的时间以及用钥匙开门的时间可忽略不计。<br><br>【编程任务】<br><br>　　试设计一个算法，帮助麦克以最快的方式到达瑞恩所在单元，营救大兵瑞恩。</p> 

 
 # 输入格式 
<p>
由文件rescue.in提供输入数据。<br>　　第1行有3个整数，分别表示N,M,P的值。第2 行是1个整数K，表示迷宫中门和墙的总数。第I+2 行（1<=I <=K），有5 个整数，依次为Xi1,Yi1,Xi2,Yi2,Gi：<br>　　当Gi >=1时，表示(Xi1,Yi1)单元与(Xi2,Yi2)单元之间有一扇第Gi类的门，当Gi=0 时，表示(Xi1,Yi1)单元与(Xi2,Yi2)单元之间有一堵不可逾越的墙（其中，|Xi1-Xi2|+|Yi1-Yi2|=1，0<=Gi <=P）。<br>　　第K+3行是一个整数S，表示迷宫中存放的钥匙总数。<br>　　第K+3+J 行(1<=J <=S)，有3个整数，依次为Xi1,Yi1,Qi：表示第J 把钥匙存放在(Xi1,Yi1)单元里，并且第J 把钥匙是用来开启第Qi类门的。（其中1<=Qi <=P）。<br>　　输入数据中同一行各相邻整数之间用一个空格分隔。</p> 

 
 # 输出格式 
<p>
程序运行结束时，将麦克营救到大兵瑞恩的最短时间的值输出到文件rescue.out 中。<br>　　如果问题无解，则输出-1。</p> 
# 样例数据
<style>
        table,table tr th, table tr td { border:1px solid #0094ff; }
        table { width: 200px; min-height: 25px; line-height: 25px; text-align: center; border-collapse: collapse;}   
    </style>
<table>
	<tr>
		<td>输入样例</td>
		<td>输出样例</td>
	</tr>
<tr><td>4 4 9
9
1 2 1 3 2
1 2 2 2 0
2 1 2 2 0
2 1 3 1 0
2 3 3 3 0
2 4 3 4 1
3 2 3 3 0
3 3 4 3 0
4 3 4 4 0
2
2 1 2
4 2 1</td><td>14</td></tr></table>
