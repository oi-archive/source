
# 题目描述

盖欧路易斯决定从地下监狱脱身。

![](/source/guoj/1199/img/aHR0cHM6Ly9pLmxvbGkubmV0LzIwMTkvMDYvMTYvNWQwNWUwMTU4YmZkMTMxNDQxLnBuZw==.png)

---

地下监狱一共有 $n$ 个房间，这些房间以 $1\sim n$ 标号，它们之间由 $n-1$ 条通道相连，使得任意两个房间之间都能够互相到达。

由于盖欧路易斯曾拯救过狱警的家人，所以狱警决定帮助盖欧路易斯。他告诉盖欧路易斯：地下监狱一般情况下是全封闭的。有很多钥匙和对应的锁孔分布在不同的房间，如果把所有钥匙分别在**恰当的时间**插入对应的锁孔，地下监狱通向地面的通道就会打开。注意，一个房间可能有多个钥匙和锁孔，一把钥匙可能和它对应的锁孔在同一房间。

地下监狱的每个房间都有一个非常强大的守卫。平时的时候，盖欧路易斯可以用“魂式”来隐匿自己的气息，保证自己不被守卫发现。但是当盖欧路易斯持有钥匙的时候，由于钥匙的气息十分特殊，“魂式”就不起作用了。这时候守卫会攻击盖欧路易斯，盖欧路易斯必须击杀守卫才能继续行动。所幸每个守卫的感知范围只有自己所管辖的房间。也就是说，只有当盖欧路易斯持有钥匙且处在房间内时，才会受到对应房间守卫的攻击。所以只有在开锁的时候，盖欧路易斯才会去碰对应的**那一把**钥匙，别的时候她是不会乱动其他钥匙的。注意，在钥匙所在的房间和锁孔所在的房间也会受到攻击。

每个守卫都有一个攻击力。如果盖欧路易斯要击杀攻击力为 $x$ 的守卫，就要花费 $x$ 点“TP”。

如果盖欧路易斯击杀了某个房间的守卫，第二天“大王”就会再次派遣一个攻击力相同的守卫去驻守该房间。

接下来的每天，狱警会给予盖欧路易斯一条信息，信息有四种：

1. 今天要把某一把钥匙插入对应的锁孔。狱警会给出钥匙所在的房间 $x$ 和锁孔所在的房间 $y$。
2. “大王”把房间 $x$ 到房间 $y$ 路径上（包含 $x$ 和 $y$）的所有房间的守卫翻转。
3. “大王”把房间 $x$ 到房间 $y$ 路径上（包含 $x$ 和 $y$）的所有房间的守卫叫出来，按照攻击力从小到大的顺序依次驻守从 $x$ 到 $y$ 的有向路径上的每一个房间。
4. “大王”新开发了一个房间，并派遣了一个攻击力为 $y$ 的守卫去驻守这个房间。与这个房间连通的有且仅有一条通道，这条通道与编号为 $x$ 的房间相连。如果当前已有 $a$ 个房间了，那么这个新房间的编号为 $a+1$。

特别地，每个守卫的攻击力都是 $1\sim 2n$ 的正整数，且任意时刻不会有两个守卫的攻击力相同。

作为非战斗人员的你，只要告诉盖欧路易斯每次她开锁的时候，至少要消耗多少点“TP”才能成功就行了。


# 输入格式

第一行两个正整数 $n$ 和 $q$，分别表示一开始地下监狱的房间数和狱警给你提供信息的天数。

下一行 $n$ 个正整数，第 $i$ 个数表示编号为 $i$ 的房间里的守卫攻击力。保证这些数互不相同。

接下来 $n-1$ 行，每行两个正整数 $x$ 和 $y$，表示有一条连接 $x$ 号房间和 $y$ 号房间的通道。

接下来 $q$ 行，每行三个正整数 $f,x,y$。第 $i$ 行的三个数代表着第 $i$ 天狱警提供的信息。$f$ 代表信息种类，相对应的信息种类参见<strong>【题目描述】</strong> 。$x$ 和 $y$ 的含义参见<strong>【题目描述】</strong> 。


# 输出格式

输出若干行，每行一个正整数。第 $i$ 行的数表示盖欧路易斯第 $i$ 次开锁时至少要消耗的“TP”值。

# 样例

#### 样例输入
```plain
5 11
8 5 1 2 6 
2 1
3 1
4 3
5 4
1 1 4 
4 4 4 
1 1 5 
2 2 1 
2 2 6 
4 6 3 
1 3 5 
2 2 5 
2 2 4 
3 6 5 
1 6 1 
```

#### 样例输出
```plain
11
17
12
16
```

# 数据范围与提示

|测试点编号|$n$|$q$|特殊性质|
|:-:|:-:|:-:|:-:|
|$1$|$\le 1000$|$\le 1000$|$f=1$|
|$2$|$\le 1000$|$\le 1000$|无|
|$3\sim 6$|$\le 50000$|$\le 50000$|只有一个信息满足 $f=1$ 且该信息的 $x$ 和 $y$ 相等，所有的房间（包括新开发的）最多只与两条通道连通|
|$7\sim 12$|$\le 100000$|$\le 100000$|$f\ne 3$|
|$13\sim 16$|$\le 100000$|$\le 100000$|所有的房间（包括新开发的）最多只与两条通道连通|
|$17\sim 20$|$\le 100000$|$\le 100000$|无|

设给出信息时的总房间数为 $a$。

对于所有数据，满足：  
$n\ge 1,q\ge 1,1\le f\le 4$

对于 $1\le f\le 3,1\le x,y\le a$，  
对于 $f=4,1\le x\le a,1\le y\le 2n$ 且 $y$ 不与之前任一守卫的攻击力相同。


