
# 题目描述

冰之妖精琪露诺最爱的冬天再一次在幻想乡降临了。为了庆贺冬天的到来，琪露诺便在雾之湖周围办起了宴会。不出所料，这件事情让同样在雾之湖周围的红魔馆很苦恼。在咲夜的~~贿赂~~请求下，灵梦决定来处理这次异变，还雾之湖一个安宁。

------

雾之湖周围有很多小溪，这些小溪从妖怪之山上流下来，被当初创建幻想乡的贤者之一紫控制。这些小溪被琪露诺冻了起来，因此雾之湖失去了水源，水量也一天天减少。但聪明的灵梦发现，这些溪流都有着某种规律，她只要解除其中一部分的封冻就能解决雾之湖的水源问题。

首先，这些溪流都从妖怪之山上流下来，却分裂成好几条溪流同时汇向雾之湖，由于紫~~老太婆~~的魔力影响，这些溪流能够允许通过的水量都不尽相同。这些溪流自妖怪之山流出之后就成为了 $n$ 条溪流，虽然在途中会有 $m-2$ 次汇向同一点，但总会重新分裂成 $n$ 条和之前一样的溪流。懒惰的灵梦发现要清理完全部的河道很麻烦，于是她找到了紫。紫告诉她，对于两个相邻节点之间的小溪，我们将它们排成一个序列，这个序列会被划分成许多连续的区间。在不同的相邻节点之间，有着不同的区间划分。对于每个长为 $l$ 的区间，$v_k(k\in[1,l])$ 表示清理这个区间中流量第 $k$ 小的小溪的单位流量费用。

简单来讲，从妖怪之山流到雾之湖有 $m$ 个点（包括妖怪之山和雾之湖），每两个相邻节点之间都有 $n$ 条边，这 $n$ 条边在任意两个相邻节点之间都是相同的，两个相邻节点之间的边如图所示，边上的数字代表边的序号（$i\in[1,m)$）：

<!-- ![](/source/guoj/1171/img/aHR0cHM6Ly9pLmxvbGkubmV0LzIwMTkvMDYvMDQvNWNmNjZmM2E0MTI2MTg2MTczLnBuZw==.png) -->

![](/source/guoj/1171/img/aHR0cHM6Ly9pLmxvbGkubmV0LzIwMTkvMDYvMTMvNWQwMjQyMjY5ZWIyMTI3MDI0LnBuZw==.png)

在输入中对于每两个相邻节点之间的溪流，我们将它们依次排成一个序列，序列中第 $i$ 条边的流量为 $c_i$。将这个序列分割成 $p$ 个**互不相交的**连续区间。

对于第 $i$ 个整数区间 $[a_i,b_i]$ 中流量第 $j$ 小的边，我们都有唯一对应的单位流量清理费用 $v_{i,j}$。但是，不同的相邻节点之间的区间划分和费用是不同的。

灵梦当然能很快算出来清理完全部小溪的总费用是多少。现在她想考考你如何用最少的费用清理小溪，以及雾之湖最终能接收到的水量是多少。

# 输入格式

第一行包含两个整数 $n$，$m$。

第二行包含 $n$ 个整数，第 $i$ 个整数 $c_i$ 表示第 $i$ 条小溪的流量。

接下来的有 $m-1$ 组输入，其中第 $i$ 组代表第 $i$ 个节点与第 $i+1$ 个节点之间的情况。

对于每组输入，第一行包含一个整数 $p$，代表紫将这些溪流分成了几个区间。

接下来的 $2p$ 行，第 $2i-1$ 行包含两个整数 $a_i$，$b_i$，代表区间 $[a_i,b_i]$。

第 $2i$ 行包含 $b_i-a_i+1$ 个整数，第 $j$ 个整数为 $v_{i,j}$，代表该区间中流量第 $j$ 小溪流的单位流量费用。

输入保证每组输入都能不重复地覆盖全部 $n$ 条溪流，即对于所有的整数区间，有

$$
\bigcup_{i=1}^p[a_i,b_i]=[1,n],\\
\bigcap_{i=1}^p[a_i,b_i]=\varnothing
$$

# 输出格式

一行两个整数，分别代表雾之湖最终能接收到的最大水量和 $\bmod 998244353$ 意义下灵梦所需要花的费用。

# 样例

#### 样例 1 输入
```plain
2 3
1 2
2
1 1
1
2 2
2
2
1 1
1
2 2
2
```

#### 样例 1 输出
```plain
3 10
```

#### 样例 2 输入
```plain
4 5
1 2 3 4
2
1 2
1 2
3 4
1 2
2
1 2
1 2
3 4
1 2
2
1 2
1 2
3 4
1 2
2
1 2
1 2
3 4
1 2
```

#### 样例 2 输出
```plain
10 64
```


# 数据范围与提示

汇点的编号为 $1\sim m$（$1$ 号节点代表妖怪之山，$m$ 号节点代表雾之湖）。

|测试点编号 | $n$ | $m$|约定|
|:-:|:-:|:-:|:-:|
|$1$ |$n\leq 10$ | $m\leq 10$|无|
|$2,3$ |$n\leq 10$ | $m\leq 100$|无|
|$4,5$ |$n\leq 100$ | $m\leq 10$|无|
|$6,7$ |$n\leq 100$ | $m\leq 1000$|无|
|$8,9,10$ |$n\leq 1000$ | $m\leq 100$|无|
|$11,12,13$ |$n\leq 1000$ | $m\leq 200$|无|
|$14,15,16,17,18$ |$n\leq 1000$ | $m\leq 1000$|无|
|$19,20$ |$n\leq 2000$ | $m\leq 100$|无|
|$21,22,23,24,25$ |$n\leq 200000$ | $m\leq 200000$|$n\times m\le 200000$|

对于 $100\%$ 的数据，$1\le n,m\le 2\times 10^5$，$1\leq p_i\leq n$，$1<c_i<1919810$，$1<v_{i,j}<114514$。

