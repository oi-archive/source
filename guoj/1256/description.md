
# 题目描述

T 公司是一家专门生产彩色珠子项链的公司，其生产的项链设计新颖、款式多样、价格适中，广受青年人的喜爱。最近 T 公司打算推出一款项链自助生产系统，使用该系统顾客可以自行设计心目中的美丽项链。

该项链自助生产系统包括硬件系统与软件系统，软件系统与用户进行交互并控制硬件系统，硬件系统接受软件系统的命令生产指定的项链。该系统的硬件系统已经完成，而软件系统尚未开发，T 公司的人找到了正在参加全国信息学竞赛的你，你能帮助 T 公司编写一个软件模拟系统吗？

一条项链包含 $N$ 个珠子，每个珠子的颜色是 $1, 2, \ldots, c$ 中的一种。项链被固定在一个平板上，平板的某个位置被标记位置 $1$，按顺时针方向其他位置被记为 $2,3,\ldots,N$。

![](/source/guoj/1256/img/aHR0cHM6Ly9pLmxvbGkubmV0LzIwMTkvMDYvMjQvNWQxMDBmMTUzMDM5MDgzMTgzLnBuZw==.png)

你将要编写的软件系统应支持如下命令：

|命令|参数限制|内容|
|:-:|:-:|:-:|
|`R k`|$0<k<N$|意为 $Rotate\ k$。将项链在平板上顺时针旋转 $k$ 个位置, 即原来处于位置 $1$ 的珠子将转至位置 $k+1$，处于位置 $2$ 的珠子将转至位置 $k+2$，依次类推。|
|`F`||意为 $Flip$。将平板沿着给定的对称轴翻转，原来处于位置 $1$ 的珠子不动，位置 $2$ 上的珠子与位置 $N$ 上的珠子互换，位置 $3$ 上的珠子与位置 $N-1$ 上的珠子互换，依次类推。|
|`S i j`|$1\le i,j\le N$|意为 $Swap\ i,j$。将位置 $i$ 上的珠子与位置 $j$ 上的珠子互换。|
|`P i j x`|$1\le i,j\le N,x\le c$|意为 $Paint\ i,j,x$。将位置 $i$ 沿顺时针方向到位置 $j$ 的一段染为颜色 $x$。|
|`C`||意为 $Count$。查询当前的项链由多少个“部分”组成，我们称项链中颜色相同的一段为一个“部分”。|
|`CS i j`|$1\le i,j\le N$|意为 $CountSegment\ i,j$。查询从位置 $i$ 沿顺时针方向到位置 $j$ 的一段中有多少个部分组成。|

# 输入格式

输入文件第一行包含两个整数 $N,c$，分别表示项链包含的珠子数目以及颜色数目。第二行包含 $N$ 个整数，$x_1,x_2,\ldots,x_n$，表示从位置 $1$ 到位置 $N$ 的珠子的颜色，$1\le x_i\le c$。第三行包含一个整数 $Q$，表示命令数目。接下来的 $Q$ 行每行一条命令，如上文所述。

# 输出格式

对于每一个 $C$ 和 $CS$ 命令，应输出一个整数代表相应的答案。

# 样例

#### 样例输入
```plain
5 3
1 2 3 2 1
4
C
R 2
P 5 5 2
CS 4 1
```
#### 样例输出
```plain
4
1
```

# 数据范围与提示

#### 评分方法
本题没有部分分，你的程序的输出只有和标准答案完全一致才能获得满分，否则不得分。

#### 数据规模和约定

对于 $60\%$ 的数据，$N\le 1 000$，$Q\le 1 000$；

对于 $100\%$ 的数据，$N\le 500 000$，$Q\le 500 000$，$c\le 1 000$。

