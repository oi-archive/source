
# Description

<div class="content"><p class="MsoPlainText" style="margin: 0cm 0cm 0pt; text-indent: 24pt"><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;"><font face="宋体">小明的爸爸给他买了一盒玩具兵，其中有</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#34;Times New Roman&#34;; mso-bidi-font-size: 10.0pt"> K</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;"><font face="宋体">个步兵，</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#34;Times New Roman&#34;; mso-bidi-font-size: 10.0pt">K</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;"><font face="宋体">个骑兵和一个天兵，个个高大威猛，形象逼真。盒子里还有一个</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#34;Times New Roman&#34;; mso-bidi-font-size: 10.0pt">M*N</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;"><font face="宋体">棋盘，每个格子</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#34;Times New Roman&#34;; mso-bidi-font-size: 10.0pt">(i,j)</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;"><font face="宋体">都有一个高度</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#34;Times New Roman&#34;; mso-bidi-font-size: 10.0pt">H<sub>ij</sub></span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;"><font face="宋体">，并且大得足以容纳所有的玩具兵。小明把所有的玩具兵都放到棋盘上去，突然想到了一种很有趣的玩法：任意挑选</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#34;Times New Roman&#34;; mso-bidi-font-size: 10.0pt">T</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;"><font face="宋体">个不同的格子，并给每个格子</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#34;Times New Roman&#34;; mso-bidi-font-size: 10.0pt">i</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;"><font face="宋体">规定一个重要值</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#34;Times New Roman&#34;; mso-bidi-font-size: 10.0pt">R<sub>i­­</sub></span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;"><font face="宋体">，游戏的目标就是每次沿东南西北之一的方向把一个玩具兵移动到其相邻的格子中（但不能移动到棋盘外面去），最终使得每个挑选出的格子</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#34;Times New Roman&#34;; mso-bidi-font-size: 10.0pt">i</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;"><font face="宋体">上恰好有</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#34;Times New Roman&#34;; mso-bidi-font-size: 10.0pt">R<sub>i</sub></span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;"><font face="宋体">个玩具兵。小明希望所有的玩具兵都在某个选定的格子中，因此他总是使选出的</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#34;Times New Roman&#34;; mso-bidi-font-size: 10.0pt">T</span><font face="宋体"><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;">个格子的重要值之和等于玩具兵的个数。为了增加难度，小明给玩具兵们的移动方式做了一些规定：</span><span lang="EN-US" style="font-size: 12pt; font-family: &#34;Times New Roman&#34;; mso-bidi-font-size: 10.0pt"><o:p></o:p></span></font></p>
<p class="MsoPlainText" style="margin: 0cm 0cm 0pt 21pt; text-indent: -21pt"><font face="宋体"><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-hansi-font-family: &#39;Times New Roman&#39;">●<span lang="EN-US"><span style="mso-spacerun: yes">  </span></span></span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;">步兵只会往高处爬，因此如果两个格子</span></font><span lang="EN-US" style="font-size: 12pt; font-family: &#34;Times New Roman&#34;; mso-bidi-font-size: 10.0pt">A</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;"><font face="宋体">和</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#34;Times New Roman&#34;; mso-bidi-font-size: 10.0pt">B</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;"><font face="宋体">相邻，当且仅当格子</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#34;Times New Roman&#34;; mso-bidi-font-size: 10.0pt">A</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;"><font face="宋体">的高度小于或等于</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#34;Times New Roman&#34;; mso-bidi-font-size: 10.0pt">B</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;"><font face="宋体">，步兵才可以从</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#34;Times New Roman&#34;; mso-bidi-font-size: 10.0pt">A</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;"><font face="宋体">移动到</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#34;Times New Roman&#34;; mso-bidi-font-size: 10.0pt">B</span><font face="宋体"><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;">。</span><span lang="EN-US" style="font-size: 12pt; font-family: &#34;Times New Roman&#34;; mso-bidi-font-size: 10.0pt"><o:p></o:p></span></font></p>
<p class="MsoPlainText" style="margin: 0cm 0cm 0pt 21pt; text-indent: -21pt; mso-list: l0 level1 lfo1; tab-stops: list 21.0pt"><span lang="EN-US" style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-hansi-font-family: &#39;Times New Roman&#39;; mso-bidi-font-family: 宋体"><span style="mso-list: Ignore"><font face="宋体">●</font><span style="font: 7pt &#34;Times New Roman&#34;">      </span></span></span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;"><font face="宋体">骑兵只会往低处跳，因此如果两个格子</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#34;Times New Roman&#34;; mso-bidi-font-size: 10.0pt">A</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;"><font face="宋体">和</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#34;Times New Roman&#34;; mso-bidi-font-size: 10.0pt">B</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;"><font face="宋体">相邻，当且仅当格子</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#34;Times New Roman&#34;; mso-bidi-font-size: 10.0pt">A</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;"><font face="宋体">的高度大于或等于</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#34;Times New Roman&#34;; mso-bidi-font-size: 10.0pt">B</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;"><font face="宋体">，骑兵才可以从</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#34;Times New Roman&#34;; mso-bidi-font-size: 10.0pt">A</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;"><font face="宋体">移动到</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#34;Times New Roman&#34;; mso-bidi-font-size: 10.0pt">B</span><font face="宋体"><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;">。</span><span lang="EN-US" style="font-size: 12pt; font-family: &#34;Times New Roman&#34;; mso-bidi-font-size: 10.0pt"><o:p></o:p></span></font></p>
<p class="MsoPlainText" style="margin: 0cm 0cm 0pt 21pt; text-indent: -21pt; mso-list: l0 level1 lfo1; tab-stops: list 21.0pt"><span lang="EN-US" style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-hansi-font-family: &#39;Times New Roman&#39;; mso-bidi-font-family: 宋体"><span style="mso-list: Ignore"><font face="宋体">●</font><span style="font: 7pt &#34;Times New Roman&#34;">      </span></span></span><font face="宋体"><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;">天兵技术全面，移动不受任何限制。</span><span lang="EN-US" style="font-size: 12pt; font-family: &#34;Times New Roman&#34;; mso-bidi-font-size: 10.0pt"><o:p></o:p></span></font></p>
<p class="MsoPlainText" style="margin: 0cm 0cm 0pt"><span lang="EN-US" style="font-size: 12pt; font-family: &#34;Times New Roman&#34;; mso-bidi-font-size: 10.0pt"><span style="mso-spacerun: yes">       </span></span><font face="宋体"><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;">可是没玩几次，小明就发现这个</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt">游戏太难了，他常常玩了好半天也达不到目的。于是，他设计了一种“超能力”，</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;">每使用一次超能力的时候，虽然不能移动任何一个玩具兵，但可对它们进行任意多次交换操作，每次交换两个玩具兵。等这次超能力使用完后又可和平常一样继续移动这些玩具兵。借助强大的超能力，这个游戏是容易玩通的，但是怎样才能让使用超能力的次数最少呢？</span><span lang="EN-US" style="font-size: 12pt; font-family: &#34;Times New Roman&#34;; mso-bidi-font-size: 10.0pt"><o:p></o:p></span></font></p>
<p class="MsoPlainText" style="margin: 0cm 0cm 0pt"><b style="mso-bidi-font-weight: normal"><span lang="EN-US"><o:p><font face="宋体" size="3"> </font></o:p></span></b></p>
<p></p></div>

# Input

<div class="content"><p class="MsoPlainText" align="left" style="margin: 0cm 0cm 0pt; text-align: left"><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt"><font face="宋体">第一行包含四个整数：</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#39;Times New Roman&#39;; mso-bidi-font-size: 10.0pt">M,N,K,T (2&lt;=M,N&lt;=100, 1&lt;=K&lt;=50, 1&lt;=T&lt;=2K+1)</span><span lang="EN-US" style="font-size: 12pt; mso-bidi-font-size: 10.0pt"><o:p></o:p></span></p>
<p class="MsoPlainText" style="margin: 0cm 0cm 0pt"><font face="宋体"><span lang="EN-US" style="font-size: 12pt; mso-bidi-font-size: 10.0pt"><span style="mso-spacerun: yes">    </span></span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt">第二行包括</span></font><span lang="EN-US" style="font-size: 12pt; font-family: &#39;Times New Roman&#39;; mso-bidi-font-size: 10.0pt">2K+1</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt"><font face="宋体">个数对</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#39;Times New Roman&#39;; mso-bidi-font-size: 10.0pt">(x<sub>i</sub>,y<sub>i</sub>)</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt"><font face="宋体">，代表各个玩具兵的初始位置。前</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#39;Times New Roman&#39;; mso-bidi-font-size: 10.0pt">K</span><font face="宋体"><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt">个代表</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;">步</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt">兵，接下来的</span></font><span lang="EN-US" style="font-size: 12pt; font-family: &#39;Times New Roman&#39;; mso-bidi-font-size: 10.0pt">K</span><font face="宋体"><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt">个代表</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;">骑兵</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt">，最后一个代表</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;">天</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt">兵。<span lang="EN-US"><o:p></o:p></span></span></font></p>
<p class="MsoPlainText" style="margin: 0cm 0cm 0pt"><font face="宋体"><span lang="EN-US" style="font-size: 12pt; mso-bidi-font-size: 10.0pt"><span style="mso-spacerun: yes">    </span></span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt">第三行包含</span></font><span lang="EN-US" style="font-size: 12pt; font-family: &#39;Times New Roman&#39;; mso-bidi-font-size: 10.0pt">T</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt"><font face="宋体">个三元组</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#39;Times New Roman&#39;; mso-bidi-font-size: 10.0pt">(x<sub>i</sub>,y<sub>i</sub>,r<sub>i</sub>)</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt"><font face="宋体">，第</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#39;Times New Roman&#39;; mso-bidi-font-size: 10.0pt">i</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt"><font face="宋体">组代表第</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#39;Times New Roman&#39;; mso-bidi-font-size: 10.0pt">i</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt"><font face="宋体">个目标格的位置和重要值。<span lang="EN-US"><o:p></o:p></span></font></span></p>
<p class="MsoPlainText" style="margin: 0cm 0cm 0pt"><span lang="EN-US" style="font-size: 12pt; font-family: &#39;Times New Roman&#39;; mso-bidi-font-size: 10.0pt"><span style="mso-spacerun: yes">        </span></span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;"><font face="宋体">以下</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#39;Times New Roman&#39;; mso-bidi-font-size: 10.0pt">M</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;"><font face="宋体">行，每行</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#39;Times New Roman&#39;; mso-bidi-font-size: 10.0pt">N</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;"><font face="宋体">个整数。其中第</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#39;Times New Roman&#39;; mso-bidi-font-size: 10.0pt">i</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;"><font face="宋体">行第</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#39;Times New Roman&#39;; mso-bidi-font-size: 10.0pt">j</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;"><font face="宋体">个数为即格子的高度</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#39;Times New Roman&#39;; mso-bidi-font-size: 10.0pt">H<sub>ij</sub></span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;"><font face="宋体">。高度是不超过</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#39;Times New Roman&#39;; mso-bidi-font-size: 10.0pt">100</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;"><font face="宋体">的正整数，注意：不同玩具兵的初始位置可能相同。输入数据保证无错，选定的</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#39;Times New Roman&#39;; mso-bidi-font-size: 10.0pt">T</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;"><font face="宋体">个格子的重要值之和保证等于</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#39;Times New Roman&#39;; mso-bidi-font-size: 10.0pt">2K+1</span><font face="宋体"><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-hansi-font-family: &#39;Times New Roman&#39;">。</span></font></p>
<p class="MsoPlainText" style="margin: 0cm 0cm 0pt"><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt"><font face="宋体"><span lang="EN-US"><o:p></o:p></span></font></span></p></div>

# Output

<div class="content"><p class="MsoPlainText" style="margin: 0cm 0cm 0pt"><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt"><font face="宋体">仅包含一行，即使用超能力的最小次数</font></span><span lang="EN-US" style="font-size: 12pt; font-family: &#39;Times New Roman&#39;; mso-bidi-font-size: 10.0pt">T</span><span style="font-size: 12pt; mso-bidi-font-size: 10.0pt"><font face="宋体">。</font></span></p></div>

# Sample Input

<div class="content"><span class="sampledata">4  6  2  5<br/>
1  1     1  5     4  1     4  5     3  3<br/>
1  2  1    2  6  1    3  2  1    3  6  1    4  3  1<br/>
3  2  6  1  3  5<br/>
2  1  7  4  4  6<br/>
2  3  1  4  3  4<br/>
4  3  4  3  2  3<br/>
</span></div>

# Sample Output

<div class="content"><span class="sampledata">1</span></div>

# Hint

<div class="content"><p></p></div>

# Source

<div class="content"><p><a href="problemset.php?search=鸣谢刘汝佳先生授权使用">鸣谢刘汝佳先生授权使用</a></p></div>

